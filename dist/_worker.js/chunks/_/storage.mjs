import{k as e,l as t,n,s as r,o,q as i,t as s,v as a,x as c,y as u,z as l,A as f,B as h,C as p,D as d,E as m,F as g,a as y,G as w,w as x,H as k,I as _,J as v,K as C,L as b,u as $}from"./nitro.mjs";import{h as S}from"./index2.mjs";import{d as A,g as j,p as P}from"./path-meta.mjs";const get=(e,t)=>t.split(".").reduce((e,t)=>e&&e[t],e),_pick=(e,t)=>Object.keys(e).filter(t).reduce((t,n)=>Object.assign(t,{[n]:e[n]}),{}),apply=e=>t=>Array.isArray(t)?t.map(t=>e(t)):e(t),detectProperties=e=>{const t=[],n=[];for(const r of e)["$","_"].includes(r)?t.push(r):n.push(r);return{prefixes:t,properties:n}},withoutKeys=(e=[])=>t=>{if(0===e.length||!t)return t;const{prefixes:n,properties:r}=detectProperties(e);return _pick(t,e=>!r.includes(e)&&!n.includes(e[0]))},withKeys=(e=[])=>t=>{if(0===e.length||!t)return t;const{prefixes:n,properties:r}=detectProperties(e);return _pick(t,e=>r.includes(e)||n.includes(e[0]))},assertArray=(e,t="Expected an array")=>{if(!Array.isArray(e))throw new TypeError(t)},ensureArray=e=>Array.isArray(e)?e:[void 0,null].includes(e)?[]:[e],I=["sort","where","only","without"];function createQuery(e,t={}){const n={};for(const e of Object.keys(t.initialParams||{}))n[e]=I.includes(e)?ensureArray(t.initialParams[e]):t.initialParams[e];const $set=(e,t=e=>e)=>(...o)=>(n[e]=t(...o),r),resolveResult=e=>t.legacy?e?.surround?e.surround:e?(e?.dirConfig&&(e.result={_path:e.dirConfig?._path,...e.result,_dir:e.dirConfig}),e?._path||Array.isArray(e)||!Object.prototype.hasOwnProperty.call(e,"result")?e:e?.result):e:e,r={params:()=>({...n,...n.where?{where:[...ensureArray(n.where)]}:{},...n.sort?{sort:[...ensureArray(n.sort)]}:{}}),only:$set("only",ensureArray),without:$set("without",ensureArray),where:$set("where",e=>[...ensureArray(n.where),...ensureArray(e)]),sort:$set("sort",e=>[...ensureArray(n.sort),...ensureArray(e)]),limit:$set("limit",e=>parseInt(String(e),10)),skip:$set("skip",e=>parseInt(String(e),10)),find:()=>e(r).then(resolveResult),findOne:()=>e($set("first")(!0)).then(resolveResult),count:()=>e($set("count")(!0)).then(resolveResult),locale:e=>r.where({_locale:e}),withSurround:$set("surround",(e,t)=>({query:e,...t})),withDirConfig:()=>$set("dirConfig")(!0)};return t.legacy?(r.findSurround=(e,t)=>r.withSurround(e,t).find().then(resolveResult),r):r}const L=/^[A-Za-z]:\//;const O=/.(\.[^./]+)$/,extname=function(e){const t=O.exec(function(e=""){return e?e.replace(/\\/g,"/").replace(L,e=>e.toUpperCase()):e}(e));return t&&t[1]||""};function createTokenizer(o,i,s){let a=Object.assign({line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const c={},u=[];let l=[],f=[];const h={consume:function(e){n(e)?(a.line++,a.column=1,a.offset+=-3===e?2:1,accountForPotentialSkip()):-1!==e&&(a.column++,a.offset++);a._bufferIndex<0?a._index++:(a._bufferIndex++,a._bufferIndex===l[a._index].length&&(a._bufferIndex=-1,a._index++));p.previous=e},enter:function(e,t){const n=t||{};return n.type=e,n.start=now(),p.events.push(["enter",n,p]),f.push(n),n},exit:function(e){const t=f.pop();return t.end=now(),p.events.push(["exit",t,p]),t},attempt:constructFactory(function(e,t){addResult(e,t.from)}),check:constructFactory(onsuccessfulcheck),interrupt:constructFactory(onsuccessfulcheck,{interrupt:!0})},p={previous:null,code:null,containerState:{},events:[],parser:o,sliceStream:sliceStream,sliceSerialize:function(e,t){return function(e,t){let n=-1;const r=[];let o;for(;++n<e.length;){const i=e[n];let s;if("string"==typeof i)s=i;else switch(i){case-5:s="\r";break;case-4:s="\n";break;case-3:s="\r\n";break;case-2:s=t?" ":"\t";break;case-1:if(!t&&o)continue;s=" ";break;default:s=String.fromCharCode(i)}o=-2===i,r.push(s)}return r.join("")}(sliceStream(e),t)},now:now,defineSkip:function(e){c[e.line]=e.column,accountForPotentialSkip()},write:function(n){if(l=e(l,n),main(),null!==l[l.length-1])return[];return addResult(i,0),p.events=t(u,p.events,p),p.events}};let d=i.tokenize.call(p,h);return i.resolveAll&&u.push(i),p;function sliceStream(e){return function(e,t){const n=t.start._index,r=t.start._bufferIndex,o=t.end._index,i=t.end._bufferIndex;let s;n===o?s=[e[n].slice(r,i)]:(s=e.slice(n,o),r>-1&&(s[0]=s[0].slice(r)),i>0&&s.push(e[o].slice(0,i)));return s}(l,e)}function now(){return Object.assign({},a)}function main(){let e;for(;a._index<l.length;){const t=l[a._index];if("string"==typeof t)for(e=a._index,a._bufferIndex<0&&(a._bufferIndex=0);a._index===e&&a._bufferIndex<t.length;)go(t.charCodeAt(a._bufferIndex));else go(t)}}function go(e){d=d(e)}function onsuccessfulcheck(e,t){t.restore()}function constructFactory(e,t){return function(n,r,o){let i,s,c,u;return Array.isArray(n)?handleListOfConstructs(n):"tokenize"in n?handleListOfConstructs([n]):function(e){return start;function start(t){const n=null!==t&&e[t],r=null!==t&&e.null;return handleListOfConstructs([...Array.isArray(n)?n:n?[n]:[],...Array.isArray(r)?r:r?[r]:[]])(t)}}(n);function handleListOfConstructs(e){return i=e,s=0,0===e.length?o:handleConstruct(e[s])}function handleConstruct(e){return function(n){u=function(){const e=now(),t=p.previous,n=p.currentConstruct,r=p.events.length,o=Array.from(f);return{restore:restore,from:r};function restore(){a=e,p.previous=t,p.currentConstruct=n,p.events.length=r,f=o,accountForPotentialSkip()}}(),c=e,e.partial||(p.currentConstruct=e);if(e.name&&p.parser.constructs.disable.null.includes(e.name))return nok();return e.tokenize.call(t?Object.assign(Object.create(p),t):p,h,ok,nok)(n)}}function ok(t){return e(c,u),r}function nok(e){return u.restore(),++s<i.length?handleConstruct(i[s]):o}}}function addResult(e,t){e.resolveAll&&!u.includes(e)&&u.push(e),e.resolve&&r(p.events,t,p.events.length-t,e.resolve(p.events.slice(t),p)),e.resolveTo&&(p.events=e.resolveTo(p.events,p))}function accountForPotentialSkip(){a.line in c&&a.column<2&&(a.column=c[a.line],a.offset+=c[a.line]-1)}}function initializeDocument(e){const t=this,r=(this.parser.delimiter||",").charCodeAt(0);return enterRow;function enterRow(t){return e.attempt({tokenize:attemptLastLine},t=>(e.consume(t),enterRow),t=>(e.enter("row"),function(t){return e.enter("column"),content(t)}(t)))(t)}function content(o){return null===o?(e.exit("column"),e.exit("row"),e.consume(o),content):34===o?function(t){return e.enter("quotedData"),e.enter("quotedDataChunk"),e.consume(t),quotedDataChunk}(o):o===r?((t.previous===r||n(t.previous)||null===t.previous)&&(e.enter("data"),e.exit("data")),e.exit("column"),e.enter("columnSeparator"),e.consume(o),e.exit("columnSeparator"),e.enter("column"),content):n(o)?(e.exit("column"),e.enter("newline"),e.consume(o),e.exit("newline"),e.exit("row"),enterRow):function(t){return e.enter("data"),dataChunk(t)}(o)}function dataChunk(t){return null===t||n(t)||t===r?(e.exit("data"),content(t)):92===t?escapeCharacter(t):(e.consume(t),dataChunk)}function escapeCharacter(t){return e.consume(t),function(t){return e.consume(t),content}}function quotedDataChunk(t){return 92===t?escapeCharacter(t):34===t?e.attempt({tokenize:attemptDoubleQuote},t=>(e.exit("quotedDataChunk"),e.enter("quotedDataChunk"),quotedDataChunk(t)),t=>(e.consume(t),e.exit("quotedDataChunk"),e.exit("quotedData"),content))(t):(e.consume(t),quotedDataChunk)}}function attemptDoubleQuote(e,t,n){return function(t){if(34!==t)return n(t);return e.enter("quoteFence"),e.consume(t),sequence};function sequence(r){return 34!==r?n(r):(e.consume(r),e.exit("quoteFence"),e=>t(e))}}function attemptLastLine(e,t,n){return function(t){if(!o(t)&&null!==t)return n(t);return e.enter("emptyLine"),continueLine(t)};function continueLine(r){return o(r)?(e.consume(r),continueLine):null===r?(e.exit("emptyLine"),t(r)):n(r)}}const q={}.hasOwnProperty,z={line:1,column:1,offset:0},fromCSV=function(e,t,n){return"string"!=typeof t&&(n=t,t=void 0),function(){const e={enter:{column:opener(openColumn),row:opener(openRow),data:onenterdata,quotedData:onenterdata},exit:{row:closer(),column:closer(),data:onexitdata,quotedData:onexitQuotedData}};return compile;function compile(t){const n={type:"root",children:[]},r=[],o={stack:[n],tokenStack:r,config:e,enter:enter,exit:exit,resume:resume};let i=-1;for(;++i<t.length;){const n=e[t[i][0]];q.call(n,t[i][1].type)&&n[t[i][1].type].call(Object.assign({sliceSerialize:t[i][2].sliceSerialize},o),t[i][1])}if(r.length>0){const e=r[r.length-1];(e[1]||defaultOnError).call(o,void 0,e[0])}return n.position={start:point(t.length>0?t[0][1].start:z),end:point(t.length>0?t[t.length-2][1].end:z)},n}function point(e){return{line:e.line,column:e.column,offset:e.offset}}function opener(e,t){return open;function open(t){enter.call(this,e(t),t)}}function enter(e,t,n){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push([t,n]),e.position={start:point(t.start)},e}function closer(e){return close;function close(e){exit.call(this,e)}}function exit(e,t){const n=this.stack.pop(),r=this.tokenStack.pop();if(!r)throw new Error("Cannot close `"+e.type+"` ("+a({start:e.start,end:e.end})+"): itâ€™s not open");if(r[0].type!==e.type)if(t)t.call(this,e,r[0]);else{(r[1]||defaultOnError).call(this,e,r[0])}return n.position.end=point(e.end),n}function resume(){return c(this.stack.pop())}function onenterdata(e){const t=this.stack[this.stack.length-1];let n=t.children[t.children.length-1];n&&"text"===n.type||(n=text(),n.position={start:point(e.start)},t.children.push(n)),this.stack.push(n)}function onexitdata(e){const t=this.stack.pop();t.value+=this.sliceSerialize(e).trim().replace(/""/g,'"'),t.position.end=point(e.end)}function onexitQuotedData(e){const t=this.stack.pop(),n=this.sliceSerialize(e);t.value+=this.sliceSerialize(e).trim().substring(1,n.length-1).replace(/""/g,'"'),t.position.end=point(e.end)}function text(){return{type:"text",value:""}}function openColumn(){return{type:"column",children:[]}}function openRow(){return{type:"row",children:[]}}}()(i((e=>createTokenizer({...e},{tokenize:initializeDocument}))(n).write(s()(e,t,!0))))};function defaultOnError(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+a({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+a({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+a({start:t.start,end:t.end})+") is still open")}function csvParse(e){Object.assign(this,{Parser:t=>fromCSV(t,e)});Object.assign(this,{Compiler:t=>e.json?(e=>{const[t,...n]=e.children,r=t.children.map(e=>e.children[0].value);return n.map(e=>e.children.reduce((e,t,n)=>(e[String(r[n])]=t.children[0]?.value,e),{}))})(t):t.children.map(e=>e.children.map(e=>e.children[0]?.value))})}const E=A({name:"csv",extensions:[".csv"],parse:async(e,t,n={})=>{const r=u().use(csvParse,{delimiter:",",json:!0,...n}),{result:o}=await r.process(t);return{_id:e,_type:"csv",body:o}}}),D=A({name:"markdown",extensions:[".md"],parse:async(e,t,n={})=>{const r={...n};r.rehypePlugins=await importPlugins(r.rehypePlugins),r.remarkPlugins=await importPlugins(r.remarkPlugins);const o=n.highlight?{...n.highlight,highlighter:"function"==typeof n.highlight?.highlighter?n.highlight.highlighter:void 0}:void 0,i=await l(t,{...r,highlight:o,remark:{plugins:r.remarkPlugins},rehype:{options:{handlers:{link:link}},plugins:r.rehypePlugins},toc:r.toc});return{...i.data,excerpt:i.excerpt,body:{...i.body,toc:i.toc},_type:"markdown",_id:e}}});async function importPlugins(e={}){const t={};for(const[n,r]of Object.entries(e))t[n]=!!r&&{instance:r.instance||await import(n).then(e=>e.default||e),options:r};return t}function link(e,t){const n={...t.attributes||{},href:f(normalizeLink(t.url))};null!==t.title&&void 0!==t.title&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function normalizeLink(e){const t=e.match(/#.+$/),n=t?t[0]:"";return e.replace(/#.+$/,"").endsWith(".md")&&(h(e)||!/^https?/.test(e)&&!e.startsWith("/"))?j(e.replace(".md"+n,""),{forceLeadingSlash:!1})+n:e}const F=A({name:"Yaml",extensions:[".yml",".yaml"],parse:(e,t)=>{const{data:n}=p(`---\n${t}\n---`);let r=n;return Array.isArray(n)&&(console.warn(`YAML array is not supported in ${e}, moving the array into the \`body\` key`),r={body:n}),{...r,_id:e,_type:"yaml"}}}),R=[E,D,A({name:"Json",extensions:[".json",".json5"],parse:async(e,t)=>{let n;return"string"==typeof t?e.endsWith("json5")?n=(await import("./index.mjs").then(function(e){return e.i}).then(e=>e.default||e)).parse(t):e.endsWith("json")&&(n=d(t)):n=t,Array.isArray(n)&&(console.warn(`JSON array is not supported in ${e}, moving the array into the \`body\` key`),n={body:n}),{...n,_id:e,_type:"json"}}}),F,P];async function transformContent(e,t,n={}){const{transformers:r=[]}=n,o={_id:e,body:t},i=extname(e),s=function(e,t=[]){let n=t.find(t=>e.match(new RegExp(t.extensions.join("|"),"i"))&&t.parse);return n||(n=R.find(t=>e.match(new RegExp(t.extensions.join("|"),"i"))&&t.parse)),n}(i,r);if(!s)return console.warn(`${i} files are not supported, "${e}" falling back to raw content`),o;const a=n[m(s.name)]||{},c=await s.parse(o._id,o.body,a),u=function(e,t=[]){return[...t.filter(t=>e.match(new RegExp(t.extensions.join("|"),"i"))&&t.transform),...R.filter(t=>e.match(new RegExp(t.extensions.join("|"),"i"))&&t.transform)]}(i,r);return await u.reduce(async(e,t)=>{const r=await e||c,o=n[m(t.name)];return!1===o?r:t.transform(r,o||{})},Promise.resolve(c))}function createMatch(e={}){const t=function(e,t={}){return{$match:(t,n)=>e(t,n),$eq:(e,t)=>t instanceof RegExp?t.test(e):e===t,$ne:(e,t)=>t instanceof RegExp?!t.test(e):e!==t,$not:(t,n)=>!e(t,n),$and:(t,n)=>(assertArray(n,"$and requires an array as condition"),n.every(n=>e(t,n))),$or:(t,n)=>(assertArray(n,"$or requires an array as condition"),n.some(n=>e(t,n))),$in:(t,n)=>ensureArray(n).some(n=>Array.isArray(t)?e(t,{$contains:n}):e(t,n)),$contains:(e,t)=>(e=Array.isArray(e)?e:String(e),ensureArray(t).every(t=>e.includes(t))),$icontains:(e,t)=>{if("string"!=typeof t)throw new TypeError("$icontains requires a string, use $contains instead");return e=String(e).toLocaleLowerCase(),ensureArray(t).every(t=>e.includes(t.toLocaleLowerCase()))},$containsAny:(e,t)=>(assertArray(t,"$containsAny requires an array as condition"),e=Array.isArray(e)?e:String(e),t.some(t=>e.includes(t))),$exists:(e,t)=>t?void 0!==e:void 0===e,$type:(e,t)=>typeof e===String(t),$regex:(e,t)=>{if(!(t instanceof RegExp)){const e=String(t).match(/\/(.*)\/([dgimsuy]*)$/);t=e?.[1]?new RegExp(e[1],e[2]||""):new RegExp(t)}return t.test(String(e||""))},$lt:(e,t)=>e<t,$lte:(e,t)=>e<=t,$gt:(e,t)=>e>t,$gte:(e,t)=>e>=t,...t||{}}}(match,e.operators);function match(e,n){return"object"!=typeof n||n instanceof RegExp?t.$eq(e,n):Object.keys(n||{}).every(r=>{const o=n[r];if(r.startsWith("$")&&t[r]){const n=t[r];return"function"==typeof n&&n(e,o)}return match(get(e,r),o)})}return match}function createPipelineFetcher(e){const t=createMatch(),n=[(e,n)=>{const r=e.result.filter(e=>ensureArray(n.where).every(n=>t(e,n)));return{...e,result:r,total:r.length}},(e,t)=>ensureArray(t.sort).forEach(t=>((e,t)=>{const n=new Intl.Collator(t.$locale,{numeric:t.$numeric,caseFirst:t.$caseFirst,sensitivity:t.$sensitivity}),r=Object.keys(t).filter(e=>!e.startsWith("$"));for(const o of r)e=e.sort((e,r)=>{const i=[get(e,o),get(r,o)].map(e=>{if(null!==e)return e instanceof Date?e.toISOString():e});return-1===t[o]&&i.reverse(),n.compare(i[0],i[1])});return e})(e.result,t)),function(e,n,r){if(n.surround){let o=((e,{query:n,before:r,after:o})=>{const i="string"==typeof n?{_path:n}:n,s=e.findIndex(e=>t(e,i));r=r??1,o=o??1;const a=new Array(r+o).fill(null,0);return-1===s?a:a.map((t,n)=>e[s-r+n+Number(n>=r)]||null)})(1===e.result?.length?r:e.result,n.surround);o=apply(withoutKeys(n.without))(o),o=apply(withKeys(n.only))(o),e.surround=o}return e}],r=[(e,t)=>{if(t.skip)return{...e,result:e.result.slice(t.skip),skip:t.skip}},(e,t)=>{if(t.limit)return{...e,result:e.result.slice(0,t.limit),limit:t.limit}},function(e,t,n){if(t.dirConfig){const r=e.result[0]?._path||t.where?.find(e=>e._path)?._path;if("string"==typeof r){const t=n.find(e=>e._path===g(r,"_dir"));t&&(e.dirConfig={_path:t._path,...withoutKeys(["_"])(t)})}}return e},(e,t)=>({...e,result:apply(withoutKeys(t.without))(e.result)}),(e,t)=>({...e,result:apply(withKeys(t.only))(e.result)})];return async t=>{const o=await e(),i=t.params(),s={result:o,limit:0,skip:0,total:o.length},a=n.reduce((e,t)=>t(e,i,o)||e,s);if(i.count)return{result:a.result.length};const c=r.reduce((e,t)=>t(e,i,o)||e,a);return i.first?{...(u=["skip","limit","total"],e=>u&&u.length?_pick(e,e=>!u.includes(e)):e)(c),result:c.result[0]}:c;var u}}async function getContentIndex(e){const t=y().content.defaultLocale;let n=await cacheStorage().getItem("content-index.json");if(!n){n=(await J(e)).reduce((e,n)=>(e[n._path]=e[n._path]||[],n._locale===t?e[n._path].unshift(n._id):e[n._path].push(n._id),e),{}),await cacheStorage().setItem("content-index.json",n)}return n}async function getIndexedContentsList(e,t){const n=t.params(),r=n?.where?.find(e=>e._path)?._path;if(!w(e)&&!n.surround&&!n.dirConfig&&("string"==typeof r||r instanceof RegExp)){const t=await getContentIndex(e),n=[...chunksFromArray(Object.keys(t).filter(e=>r.test?r.test(e):e===String(r)).flatMap(e=>t[e]),10)],o=[];for await(const t of n){const n=await Promise.all(t.map(t=>getContent(e,t)));o.push(...n)}return o}return J(e)}const M=Object.freeze(Object.defineProperty({__proto__:null,getContentIndex:getContentIndex,getIndexedContentsList:getIndexedContentsList},Symbol.toStringTag,{value:"Module"})),Q=[];let T,W,K;const sourceStorage=()=>(T||(T=_(v(),"content:source")),T),cacheStorage=()=>(W||(W=_(v(),"cache:content")),W),cacheParsedStorage=()=>(K||(K=_(v(),"cache:content:parsed")),K),contentConfig=()=>y().content,H="'\"?#/".split(""),contentIgnorePredicate=e=>{const t=function(e){const t=["/\\.","/-",...e.filter(e=>e)].map(e=>new RegExp(e));return function(e){const n="/"+e.replace(/:/g,"/");return t.some(e=>e.test(n))}}(contentConfig().ignores);return!e.startsWith("preview:")&&!t(e)&&(!H.some(t=>e.includes(t))||(console.warn(`Ignoring [${e}]. File name should not contain any of the following characters: ${H.join(", ")}`),!1))},getContentsIds=async(e,t)=>{let n=[];n=await cacheParsedStorage().getKeys(t);const r=sourceStorage();if(0===n.length&&(n=await r.getKeys(t)),w(e)){const{key:o}=C(e),i=`preview:${o}:${t||""}`,s=await r.getKeys(i);if(s.length){const e=new Set(n);await Promise.all(s.map(async t=>{const n=await r.getMeta(t);n?.__deleted?e.delete(t.substring(i.length)):e.add(t.substring(i.length))})),n=Array.from(e)}}return n.filter(contentIgnorePredicate)};function*chunksFromArray(e,t){for(let n=0;n<e.length;n+=t)yield e.slice(n,n+t)}const J=(()=>{let e=null;return(t,n)=>t.context.__contentList?t.context.__contentList:(e||(e=(async(e,t)=>{const n=[...chunksFromArray(await getContentsIds(e,t),10)],r=[];for(const t of n){const n=await Promise.all(t.map(t=>getContent(e,t)));r.push(...n)}return r.filter(e=>e&&e._path)})(t,n),e.then(n=>{t.context.__contentList=n,e=null})),e)})(),N={},getContent=async(e,t)=>{const n=t;if(!contentIgnorePredicate(t))return{_id:n,body:null};const r=sourceStorage(),o=cacheParsedStorage();if(w(e)){const{key:n}=C(e),o=`preview:${n}:${t}`;await r.getItem(o)&&(t=o)}const i=await o.getItem(t);if(i)return i.parsed;const s=contentConfig(),a=await r.getMeta(t),c=a.mtime,u=a.size||0,l=S({mtime:c,size:u,version:s.cacheVersion,integrity:s.cacheIntegrity});return i?.hash===l?i.parsed:(N[t+l]||(N[t+l]=new Promise(async e=>{const i=await r.getItem(t);if(null===i)return e({_id:n,body:null});const s=await parseContent(n,i);await o.setItem(t,{parsed:s,hash:l}).catch(()=>{}),e(s),delete N[t+l]})),N[t+l])},parseContent=async(e,t,n={})=>{const r=$(),o=contentConfig(),i=b(n,{markdown:{...o.markdown,highlight:o.highlight},csv:o.csv,yaml:o.yaml,transformers:Q,pathMeta:{defaultLocale:o.defaultLocale,locales:o.locales,respectPathCase:o.respectPathCase}}),s={_id:e,body:"string"==typeof t?t.replace(/\r\n|\r/g,"\n"):t};await r.hooks.callHook("content:file:beforeParse",s);const a=await transformContent(e,s.body,i);return await r.hooks.callHook("content:file:afterParse",a),a},createServerQueryFetch=e=>t=>createPipelineFetcher(()=>getIndexedContentsList(e,t))(t);const Y=Object.freeze(Object.defineProperty({__proto__:null,cacheParsedStorage:cacheParsedStorage,cacheStorage:cacheStorage,chunksFromArray:chunksFromArray,createServerQueryFetch:createServerQueryFetch,getContent:getContent,getContentsIds:getContentsIds,getContentsList:J,parseContent:parseContent,serverQueryContent:function(e,t,...n){const{advanceQuery:r}=y().public.content.experimental,o=contentConfig(),i=createQuery(createServerQueryFetch(e),r?{initialParams:"string"!=typeof t&&t||{},legacy:!1}:{initialParams:"string"!=typeof t&&t||{},legacy:!0});let s;"string"==typeof t&&(s=x(g(t,...n)));const a=i.params;return i.params=()=>{const e=a();if(s&&(e.where=e.where||[],e.first&&0===(e.where||[]).length?e.where.push({_path:k(s)}):e.where.push({_path:new RegExp(`^${s.replace(/[-[\]{}()*+.,^$\s/]/g,"\\$&")}`)})),e.sort?.length||(e.sort=[{_stem:1,$numeric:!0}]),e.where=e.where||[],e.where.find(e=>void 0!==e._draft)||e.where.push({_draft:{$ne:!0}}),o.locales.length){const t=e.where?.find(e=>e._locale)?._locale;t||(e.where=e.where||[],e.where.push({_locale:o.defaultLocale}))}return e},i},sourceStorage:sourceStorage},Symbol.toStringTag,{value:"Module"}));export{M as c,Y as s};
//# sourceMappingURL=storage.mjs.map
